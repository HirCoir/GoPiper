<!DOCTYPE html>
<html class="dark" lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Piper TTS</title>
    <link href="https://fonts.googleapis.com" rel="preconnect"/>
    <link crossorigin="" href="https://fonts.gstatic.com" rel="preconnect"/>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;700;900&display=swap" rel="stylesheet"/>
    <link href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined" rel="stylesheet"/>
    <script src="https://cdn.tailwindcss.com?plugins=forms"></script>
    <script>
    tailwind.config = {
      darkMode: "class",
      theme: {
        extend: {
          colors: {
            "primary": "#0575d1",
            "background-light": "#f5f7f8",
            "background-dark": "#0f1a23",
          },
          fontFamily: {
            "display": ["Inter"]
          },
          borderRadius: {
            "DEFAULT": "0.5rem",
            "lg": "1rem",
            "xl": "1.5rem",
            "full": "9999px"
          },
        },
      },
    }
  </script>
    <style>
        body {
            font-family: 'Inter', sans-serif;
        }
        .material-symbols-outlined {
            font-variation-settings:
            'FILL' 0,
            'wght' 400,
            'GRAD' 0,
            'opsz' 24
        }
        
        /* Custom styles for functionality */
        .model-card {
            display: flex;
            align-items: center;
            gap: 12px;
            padding: 10px;
            margin-bottom: 4px;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.2s ease;
            border: 1px solid transparent;
        }
        
        .model-card:hover {
            background: rgba(255, 255, 255, 0.1);
        }
        
        .model-card.selected {
            background: rgba(5, 117, 209, 0.2) !important;
            border: 1px solid rgba(5, 117, 209, 0.4) !important;
        }
        
        .model-image, .model-image-placeholder {
            width: 36px;
            height: 36px;
            border-radius: 50%;
            background: rgba(255, 255, 255, 0.1);
            display: flex;
            align-items: center;
            justify-content: center;
            flex-shrink: 0;
            object-fit: cover;
        }
        
        .model-image-placeholder {
            color: rgba(255, 255, 255, 0.5);
            font-size: 1.2rem;
        }
        
        .model-info {
            flex: 1;
            min-width: 0;
        }
        
        .model-name {
            font-weight: 600;
            font-size: 0.875rem;
            margin-bottom: 2px;
            color: white;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
        }
        
        .model-description {
            font-size: 0.75rem;
            color: rgba(255, 255, 255, 0.6);
            margin-bottom: 4px;
            display: -webkit-box;
            -webkit-line-clamp: 2;
            -webkit-box-orient: vertical;
            overflow: hidden;
        }
        
        .model-meta {
            display: flex;
            gap: 12px;
            font-size: 0.7rem;
            color: rgba(255, 255, 255, 0.5);
        }
        
        .model-language, .model-source {
            display: flex;
            align-items: center;
            gap: 4px;
        }
        
        .selected-model-image, .selected-model-placeholder {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background: rgba(255, 255, 255, 0.1);
            display: flex;
            align-items: center;
            justify-content: center;
            flex-shrink: 0;
            object-fit: cover;
        }
        
        .selected-model-placeholder {
            color: rgba(255, 255, 255, 0.5);
            font-size: 1.5rem;
        }
        
        .selected-model-name {
            font-weight: 600;
            font-size: 0.95rem;
            color: white;
        }
        
        .selected-model-language {
            font-size: 0.8rem;
            color: rgba(255, 255, 255, 0.7);
        }
        
        .hidden {
            display: none !important;
        }
        
        .loading-spinner {
            width: 14px;
            height: 14px;
            border: 2px solid rgba(255, 255, 255, 0.2);
            border-top: 2px solid white;
            border-radius: 50%;
            animation: spin 1s linear infinite;
        }
        
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        
        /* Settings panel styles */
        .settings-panel {
            position: fixed;
            top: 0;
            right: 0;
            width: 320px;
            height: 100vh;
            background: rgba(15, 26, 35, 0.98);
            backdrop-filter: blur(20px);
            -webkit-backdrop-filter: blur(20px);
            padding: 16px;
            transform: translateX(100%);
            transition: transform 0.3s ease;
            z-index: 1000;
            overflow-y: auto;
            border-left: 1px solid rgba(255, 255, 255, 0.1);
        }
        
        .settings-panel:not(.hidden) {
            transform: translateX(0);
        }
        
        .settings-section {
            margin-bottom: 20px;
        }
        
        .setting-item {
            margin-bottom: 12px;
        }
        
        .setting-item label {
            display: block;
            margin-bottom: 6px;
            font-size: 0.875rem;
            color: rgba(255, 255, 255, 0.8);
        }
        
        .setting-item input[type="number"],
        .setting-item input[type="text"],
        .setting-item select {
            width: 100%;
            padding: 8px 12px;
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 8px;
            background: rgba(255, 255, 255, 0.05);
            color: white;
            font-size: 0.875rem;
        }
        
        .setting-item input:focus {
            outline: none;
            border-color: #0575d1;
            box-shadow: 0 0 0 2px rgba(5, 117, 209, 0.2);
        }
        
        .folder-paths {
            max-height: 150px;
            overflow-y: auto;
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 8px;
            background: rgba(255, 255, 255, 0.05);
            margin-bottom: 8px;
        }
        
        .folder-path-item {
            padding: 8px;
            border-bottom: 1px solid rgba(255, 255, 255, 0.05);
        }
        
        .folder-path-item:last-child {
            border-bottom: none;
        }
        
        .folder-info {
            display: flex;
            align-items: center;
            gap: 8px;
            font-size: 0.8rem;
        }
        
        .folder-status {
            margin-left: auto;
            padding: 2px 8px;
            border-radius: 12px;
            font-size: 0.7rem;
            font-weight: 500;
        }
        
        .status-available {
            background: rgba(76, 175, 80, 0.2);
            color: #4caf50;
        }
        
        .status-missing {
            background: rgba(244, 67, 54, 0.2);
            color: #f44336;
        }
        
        .btn-secondary {
            padding: 8px 14px;
            background: rgba(255, 255, 255, 0.1);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 8px;
            color: white;
            cursor: pointer;
            transition: all 0.2s ease;
            font-size: 0.875rem;
        }
        
        .btn-secondary:hover {
            background: rgba(255, 255, 255, 0.15);
        }
        
        .progress-container {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: rgba(15, 26, 35, 0.98);
            padding: 24px;
            border-radius: 12px;
            border: 1px solid rgba(255, 255, 255, 0.1);
            z-index: 2000;
            min-width: 240px;
            text-align: center;
        }
        
        .progress-message {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 12px;
            font-size: 1rem;
            color: white;
        }
        
        .notification {
            position: fixed;
            top: 16px;
            right: 16px;
            min-width: 240px;
            max-width: 320px;
            display: flex;
            align-items: center;
            gap: 12px;
            padding: 12px 16px;
            border-radius: 12px;
            z-index: 2000;
            background: rgba(15, 26, 35, 0.98);
            border: 1px solid rgba(255, 255, 255, 0.1);
        }
        
        .notification-error {
            border-left: 4px solid #f44336;
        }
        
        .notification-success {
            border-left: 4px solid #4caf50;
        }
        
        .notification-close {
            background: none;
            border: none;
            color: white;
            cursor: pointer;
            margin-left: auto;
            padding: 4px;
            border-radius: 4px;
            transition: background 0.2s ease;
        }
        
        .notification-close:hover {
            background: rgba(255, 255, 255, 0.1);
        }
        
        /* Custom scrollbar */
        ::-webkit-scrollbar {
            width: 6px;
            height: 6px;
        }
        
        ::-webkit-scrollbar-track {
            background: rgba(255, 255, 255, 0.05);
            border-radius: 3px;
        }
        
        ::-webkit-scrollbar-thumb {
            background: rgba(255, 255, 255, 0.2);
            border-radius: 3px;
        }
        
        ::-webkit-scrollbar-thumb:hover {
            background: rgba(255, 255, 255, 0.3);
        }
    </style>
</head>
<body class="bg-background-dark font-display text-white">
    <div class="flex h-screen w-full flex-col">
        <!-- Header -->
        <header class="flex items-center justify-between whitespace-nowrap border-b border-white/10 px-6 py-3">
            <div class="flex items-center gap-3 text-white">
                <div class="size-6 text-primary">
                    <svg fill="none" viewBox="0 0 48 48" xmlns="http://www.w3.org/2000/svg">
                        <path clip-rule="evenodd" d="M39.475 21.6262C40.358 21.4363 40.6863 21.5589 40.7581 21.5934C40.7876 21.655 40.8547 21.857 40.8082 22.3336C40.7408 23.0255 40.4502 24.0046 39.8572 25.2301C38.6799 27.6631 36.5085 30.6631 33.5858 33.5858C30.6631 36.5085 27.6632 38.6799 25.2301 39.8572C24.0046 40.4502 23.0255 40.7407 22.3336 40.8082C21.8571 40.8547 21.6551 40.7875 21.5934 40.7581C21.5589 40.6863 21.4363 40.358 21.6262 39.475C21.8562 38.4054 22.4689 36.9657 23.5038 35.2817C24.7575 33.2417 26.5497 30.9744 28.7621 28.762C30.9744 26.5497 33.2417 24.7574 35.2817 23.5037C36.9657 22.4689 38.4054 21.8562 39.475 21.6262ZM4.41189 29.2403L18.7597 43.5881C19.8813 44.7097 21.4027 44.9179 22.7217 44.7893C24.0585 44.659 25.5148 44.1631 26.9723 43.4579C29.9052 42.0387 33.2618 39.5667 36.4142 36.4142C39.5667 33.2618 42.0387 29.9052 43.4579 26.9723C44.1631 25.5148 44.659 24.0585 44.7893 22.7217C44.9179 21.4027 44.7097 19.8813 43.5881 18.7597L29.2403 4.41187C27.8527 3.02428 25.8765 3.02573 24.2861 3.36776C22.6081 3.72863 20.7334 4.58419 18.8396 5.74801C16.4978 7.18716 13.9881 9.18353 11.5858 11.5858C9.18354 13.988 7.18717 16.4978 5.74802 18.8396C4.58421 20.7334 3.72865 22.6081 3.36778 24.2861C3.02574 25.8765 3.02429 27.8527 4.41189 29.2403Z" fill="currentColor" fill-rule="evenodd"></path>
                    </svg>
                </div>
                <h1 class="text-lg font-bold">Piper TTS</h1>
            </div>
            <div class="flex items-center gap-4">
                <button id="settings-btn" class="flex h-10 w-10 items-center justify-center rounded-full bg-white/10 text-white/80 transition-colors hover:bg-white/20 hover:text-white">
                    <span class="material-symbols-outlined text-2xl">settings</span>
                </button>
            </div>
        </header>

        <!-- Main Content -->
        <main class="flex flex-1 gap-6 p-6 overflow-hidden">
            <!-- Left Panel -->
            <div class="flex flex-1 flex-col gap-6">
                <!-- Text Input -->
                <div class="flex flex-1 flex-col rounded-lg bg-white/5 p-4 backdrop-blur-xl">
                    <textarea 
                        id="text-input" 
                        class="w-full flex-1 resize-none bg-transparent text-white placeholder-white/50 focus:outline-none" 
                        placeholder="Escribe o pega aquí el texto que deseas convertir a voz..."></textarea>
                    <div class="flex items-center justify-end mt-4">
                        <button id="generate-btn" disabled class="rounded bg-primary px-6 py-2 text-sm font-bold text-white transition-opacity hover:opacity-90 disabled:opacity-50 disabled:cursor-not-allowed">
                            Selecciona un modelo primero
                        </button>
                    </div>
                </div>

                <!-- Audio Player -->
                <div id="audio-container" class="hidden rounded-lg bg-white/5 p-4 backdrop-blur-xl">
                    <div class="flex items-center gap-4">
                        <div class="size-14 shrink-0 rounded-lg bg-primary/20 flex items-center justify-center">
                            <span class="material-symbols-outlined text-primary text-3xl">volume_up</span>
                        </div>
                        <div class="flex-1 overflow-hidden">
                            <p class="truncate font-bold text-white">Audio Generado</p>
                            <p class="truncate text-sm text-white/60">Piper TTS</p>
                        </div>
                        <button id="play-audio-btn" class="flex h-10 w-10 shrink-0 items-center justify-center rounded-full bg-primary text-white transition-opacity hover:opacity-90">
                            <span class="material-symbols-outlined text-2xl">play_arrow</span>
                        </button>
                    </div>
                    <audio id="audio-player" controls class="w-full mt-4">
                        Tu navegador no soporta el elemento de audio.
                    </audio>
                </div>
            </div>

            <!-- Right Panel - Model Selection -->
            <div class="flex w-[360px] flex-col gap-4 rounded-lg bg-white/5 p-4 backdrop-blur-xl">
                <!-- Search -->
                <div class="relative">
                    <span class="material-symbols-outlined pointer-events-none absolute left-3 top-1/2 -translate-y-1/2 text-white/50">search</span>
                    <input 
                        id="model-search" 
                        class="w-full rounded border-none bg-black/20 py-2 pl-10 pr-4 text-white placeholder-white/50 focus:outline-none focus:ring-2 focus:ring-primary" 
                        placeholder="Buscar modelos"/>
                </div>

                <!-- Model List -->
                <div class="flex-1 space-y-2 overflow-y-auto">
                    <div class="flex items-center justify-between">
                        <h2 class="text-lg font-bold text-white">Modelos Disponibles</h2>
                        <span id="model-count" class="text-sm text-white/50">0</span>
                    </div>
                    <div id="model-list" class="space-y-1">
                        <div class="text-center py-8 text-white/50">
                            <div class="loading-spinner mx-auto mb-2"></div>
                            <p>Cargando modelos...</p>
                        </div>
                    </div>
                </div>

                <!-- Selected Model -->
                <div>
                    <h2 class="mb-2 text-lg font-bold text-white">Modelo Seleccionado</h2>
                    <div id="selected-model" class="rounded bg-primary/20 p-3">
                        <p class="font-semibold text-white">Ningún modelo seleccionado</p>
                        <p class="text-sm text-white/70">Selecciona un modelo de la lista</p>
                    </div>
                </div>
            </div>
        </main>
    </div>

    <!-- Settings Panel -->
    <div class="settings-panel hidden" id="settings-panel">
        <div class="flex justify-between items-center mb-6 pb-4 border-b border-white/10">
            <h2 class="text-xl font-bold text-white flex items-center gap-2">
                <span class="material-symbols-outlined">settings</span>
                Configuración
            </h2>
            <button id="close-settings" class="text-white/80 hover:text-white transition-colors">
                <span class="material-symbols-outlined">close</span>
            </button>
        </div>

        <!-- Model Folders -->
        <div class="settings-section">
            <h3 class="text-base font-semibold text-white mb-3 flex items-center gap-2">
                <span class="material-symbols-outlined text-lg">folder</span>
                Carpetas de Modelos
            </h3>
            <div class="folder-paths" id="folder-paths">
                <div class="folder-path-item">
                    <div class="folder-info">
                        <div class="loading-spinner"></div>
                        <span>Cargando rutas...</span>
                    </div>
                </div>
            </div>
            <div class="flex gap-2">
                <button class="btn-secondary flex-1" id="add-folder-btn">
                    <span class="material-symbols-outlined text-sm">add</span>
                    Agregar
                </button>
                <button class="btn-secondary flex-1" id="rescan-btn">
                    <span class="material-symbols-outlined text-sm">refresh</span>
                    Reescanear
                </button>
            </div>
        </div>

        <!-- Processing Settings -->
        <div class="settings-section">
            <h3 class="text-base font-semibold text-white mb-3 flex items-center gap-2">
                <span class="material-symbols-outlined text-lg">memory</span>
                Configuración de Procesamiento
            </h3>
            
            <div class="setting-item">
                <label class="flex items-center gap-2 cursor-pointer">
                    <input type="checkbox" id="auto-threads-setting" checked class="h-4 w-4 border-white/30 bg-transparent text-primary focus:ring-1 focus:ring-primary">
                    <span>Detectar automáticamente hilos de CPU</span>
                </label>
                <div class="text-xs text-white/50 mt-2" id="cpu-info">
                    CPU detectado: <span id="cpu-cores">-</span> núcleos
                </div>
            </div>

            <div class="setting-item hidden" id="manual-threads-container">
                <label for="max-threads-setting">Máximo de procesos simultáneos (1-32)</label>
                <input type="number" id="max-threads-setting" min="1" max="32" value="8">
                <div class="text-xs text-white/50 mt-2">
                    Recomendado: <span id="recommended-threads">8</span> (2x núcleos de CPU)
                </div>
            </div>

            <div class="setting-item">
                <div class="text-sm p-3 bg-white/5 rounded-lg space-y-1">
                    <div class="flex justify-between">
                        <span>Estado actual:</span>
                        <span id="queue-status" class="font-medium">-</span>
                    </div>
                    <div class="flex justify-between">
                        <span>Ejecutándose:</span>
                        <span id="running-processes" class="font-medium">0</span>
                    </div>
                    <div class="flex justify-between">
                        <span>En cola:</span>
                        <span id="queued-processes" class="font-medium">0</span>
                    </div>
                </div>
            </div>
        </div>

        <!-- Audio Settings -->
        <div class="settings-section">
            <h3 class="text-base font-semibold text-white mb-3 flex items-center gap-2">
                <span class="material-symbols-outlined text-lg">tune</span>
                Configuración de Audio
            </h3>
            
            <div class="setting-item">
                <label for="speaker-setting">Hablante (Speaker ID)</label>
                <input type="number" id="speaker-setting" min="0" max="10" value="0">
            </div>

            <div class="setting-item">
                <label for="noise-scale-setting">Escala de Ruido (0.0 - 1.0)</label>
                <input type="number" id="noise-scale-setting" min="0" max="1" step="0.001" value="0.667">
            </div>

            <div class="setting-item">
                <label for="length-scale-setting">Escala de Longitud (0.5 - 2.0)</label>
                <input type="number" id="length-scale-setting" min="0.5" max="2" step="0.1" value="1.0">
            </div>

            <div class="setting-item">
                <label for="noise-w-setting">Ruido W (0.0 - 1.0)</label>
                <input type="number" id="noise-w-setting" min="0" max="1" step="0.1" value="0.8">
            </div>
        </div>
    </div>

    <!-- Progress Container -->
    <div class="progress-container hidden" id="progress-container">
        <div class="progress-message">
            <div class="loading-spinner"></div>
            <span>Procesando...</span>
        </div>
    </div>

    <script src="renderer.js"></script>
</body>
</html>
